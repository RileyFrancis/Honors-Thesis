2026-02-05 16:13:50,850 - BrainGNN - INFO - ==================================================
2026-02-05 16:13:50,860 - BrainGNN - INFO - Loading configuration from configs/diagnostic.yaml
2026-02-05 16:13:50,871 - BrainGNN - INFO - ==================================================
2026-02-05 16:13:50,882 - BrainGNN - INFO - Configuration loaded successfully
2026-02-05 16:13:50,903 - BrainGNN - INFO - Using device: cuda:0
2026-02-05 16:13:50,906 - BrainGNN - INFO - 
==================================================
2026-02-05 16:13:50,907 - BrainGNN - INFO - Configuration Summary
2026-02-05 16:13:50,908 - BrainGNN - INFO - ==================================================
2026-02-05 16:13:50,911 - BrainGNN - INFO - Run Directory: /home/rif17002/honors_thesis/runs/2026-02-05_16-13-50
2026-02-05 16:13:50,912 - BrainGNN - INFO - Data:
2026-02-05 16:13:50,913 - BrainGNN - INFO -   Data Directory: /shared/healthinfolab/datasets/ABCD/Irritability/WholeBrainTaskfMRI/UConn/data
2026-02-05 16:13:50,913 - BrainGNN - INFO -   Labels CSV: /shared/healthinfolab/datasets/ABCD/Irritability/WholeBrainTaskfMRI/UConn/subject_lists/CBCL_PLPH_m0m24_MID_n3705.csv
2026-02-05 16:13:50,914 - BrainGNN - INFO -   Contrast Type: reward
2026-02-05 16:13:50,915 - BrainGNN - INFO -   Edge Threshold: 0.0
2026-02-05 16:13:50,915 - BrainGNN - INFO -   Use Absolute Values: False
2026-02-05 16:13:50,922 - BrainGNN - INFO - 
Model:
2026-02-05 16:13:50,929 - BrainGNN - INFO -   GNN Type: GCN
2026-02-05 16:13:50,936 - BrainGNN - INFO -   Hidden Channels: 32
2026-02-05 16:13:50,946 - BrainGNN - INFO -   Num Layers: 2
2026-02-05 16:13:50,950 - BrainGNN - INFO -   Dropout: 0.2
2026-02-05 16:13:50,954 - BrainGNN - INFO - 
Training:
2026-02-05 16:13:50,956 - BrainGNN - INFO -   Batch Size: 128
2026-02-05 16:13:50,958 - BrainGNN - INFO -   Learning Rate: 0.01
2026-02-05 16:13:50,959 - BrainGNN - INFO -   Weight Decay: 0.0
2026-02-05 16:13:50,959 - BrainGNN - INFO -   Epochs: 500
2026-02-05 16:13:50,960 - BrainGNN - INFO -   Patience: 100
2026-02-05 16:13:50,960 - BrainGNN - INFO -   Random Seed: 42
2026-02-05 16:13:50,962 - BrainGNN - INFO - 
Imbalance Handling:
2026-02-05 16:13:50,963 - BrainGNN - INFO -   Class Weights: False
2026-02-05 16:13:50,963 - BrainGNN - INFO -   Focal Loss: False
2026-02-05 16:13:50,964 - BrainGNN - INFO -   Oversampling: False
2026-02-05 16:13:50,964 - BrainGNN - INFO -   Monitor Metric: balanced_acc
2026-02-05 16:13:50,965 - BrainGNN - INFO - 
==================================================
2026-02-05 16:13:50,966 - BrainGNN - INFO - Loading reward contrast dataset...
2026-02-05 16:13:50,967 - BrainGNN - INFO - ==================================================
2026-02-05 16:13:50,977 - BrainGNN - INFO - Loaded 3705 subjects from labels file
2026-02-05 16:13:59,718 - BrainGNN - INFO - Found 2853 subjects with complete data
2026-02-05 16:13:59,721 - BrainGNN - INFO - Class distribution:
2026-02-05 16:13:59,731 - BrainGNN - INFO -   Class 0: 2543 (89.1%)
2026-02-05 16:13:59,747 - BrainGNN - INFO -   Class 1: 310 (10.9%)
2026-02-05 16:13:59,752 - BrainGNN - INFO -   Imbalance ratio: 8.20:1
2026-02-05 16:13:59,759 - BrainGNN - INFO - Dataset loaded successfully with 2853 subjects
2026-02-05 16:13:59,811 - BrainGNN - INFO - Number of ROIs (nodes): 352
2026-02-05 16:13:59,823 - BrainGNN - INFO - Number of node features: 6
2026-02-05 16:13:59,832 - BrainGNN - INFO - Number of edges: 123552
2026-02-05 16:13:59,838 - BrainGNN - INFO - Splitting dataset into train/val/test...
2026-02-05 16:15:05,288 - BrainGNN - INFO - Dataset split:
2026-02-05 16:15:05,295 - BrainGNN - INFO -   Train: 1825 samples
2026-02-05 16:15:05,299 - BrainGNN - INFO -   Val:   457 samples
2026-02-05 16:15:05,303 - BrainGNN - INFO -   Test:  571 samples
2026-02-05 16:15:13,322 - BrainGNN - INFO -   Train class dist: Class 0: 1627, Class 1: 198 (10.8% minority)
2026-02-05 16:15:15,509 - BrainGNN - INFO -   Val class dist: Class 0: 407, Class 1: 50 (10.9% minority)
2026-02-05 16:15:18,377 - BrainGNN - INFO -   Test class dist: Class 0: 509, Class 1: 62 (10.9% minority)
2026-02-05 16:15:33,744 - BrainGNN - INFO - 
Initializing GCN model...
2026-02-05 16:15:33,795 - BrainGNN - INFO - Model parameters: 1,970
2026-02-05 16:15:33,801 - BrainGNN - INFO - 
==================================================
2026-02-05 16:15:33,804 - BrainGNN - INFO - Training model...
2026-02-05 16:15:33,811 - BrainGNN - INFO - Monitoring: balanced_acc
2026-02-05 16:15:33,822 - BrainGNN - INFO - ==================================================
2026-02-05 16:15:34,035 - BrainGNN - INFO - Starting training for up to 500 epochs...
2026-02-05 16:15:37,578 - BrainGNN - INFO - Epoch 1: New best balanced_acc: 0.5000
2026-02-05 16:16:04,738 - BrainGNN - INFO - Epoch 010: Train Loss: 0.3469, Train Acc: 0.8915, Train Balanced Acc: 0.5000 | Val Loss: 0.4163, Val Acc: 0.8906, Val Balanced Acc: 0.5000, Val F1: 0.0000, Val AUC: 0.4928
2026-02-05 16:16:36,220 - BrainGNN - INFO - Epoch 020: Train Loss: 0.3488, Train Acc: 0.8915, Train Balanced Acc: 0.5000 | Val Loss: 0.3665, Val Acc: 0.8906, Val Balanced Acc: 0.5000, Val F1: 0.0000, Val AUC: 0.5005
2026-02-05 16:17:08,025 - BrainGNN - INFO - Epoch 030: Train Loss: 0.3418, Train Acc: 0.8915, Train Balanced Acc: 0.5000 | Val Loss: 0.3548, Val Acc: 0.8906, Val Balanced Acc: 0.5000, Val F1: 0.0000, Val AUC: 0.4375
2026-02-05 16:17:38,131 - BrainGNN - INFO - Epoch 040: Train Loss: 0.3463, Train Acc: 0.8915, Train Balanced Acc: 0.5000 | Val Loss: 0.3521, Val Acc: 0.8906, Val Balanced Acc: 0.5000, Val F1: 0.0000, Val AUC: 0.4320
2026-02-05 16:18:08,016 - BrainGNN - INFO - Epoch 050: Train Loss: 0.3424, Train Acc: 0.8915, Train Balanced Acc: 0.5000 | Val Loss: 0.3567, Val Acc: 0.8906, Val Balanced Acc: 0.5000, Val F1: 0.0000, Val AUC: 0.4813
2026-02-05 16:18:38,759 - BrainGNN - INFO - Epoch 060: Train Loss: 0.3433, Train Acc: 0.8915, Train Balanced Acc: 0.5000 | Val Loss: 0.3508, Val Acc: 0.8906, Val Balanced Acc: 0.5000, Val F1: 0.0000, Val AUC: 0.5249
2026-02-05 16:19:08,171 - BrainGNN - INFO - Epoch 070: Train Loss: 0.3435, Train Acc: 0.8915, Train Balanced Acc: 0.5000 | Val Loss: 0.3490, Val Acc: 0.8906, Val Balanced Acc: 0.5000, Val F1: 0.0000, Val AUC: 0.4122
2026-02-05 16:19:37,721 - BrainGNN - INFO - Epoch 080: Train Loss: 0.3415, Train Acc: 0.8915, Train Balanced Acc: 0.5000 | Val Loss: 0.3516, Val Acc: 0.8906, Val Balanced Acc: 0.5000, Val F1: 0.0000, Val AUC: 0.4203
2026-02-05 16:20:07,217 - BrainGNN - INFO - Epoch 090: Train Loss: 0.3417, Train Acc: 0.8915, Train Balanced Acc: 0.5000 | Val Loss: 0.3839, Val Acc: 0.8906, Val Balanced Acc: 0.5000, Val F1: 0.0000, Val AUC: 0.4640
2026-02-05 16:20:36,696 - BrainGNN - INFO - Epoch 100: Train Loss: 0.3418, Train Acc: 0.8915, Train Balanced Acc: 0.5000 | Val Loss: 0.3556, Val Acc: 0.8906, Val Balanced Acc: 0.5000, Val F1: 0.0000, Val AUC: 0.4842
2026-02-05 16:20:39,642 - BrainGNN - INFO - Early stopping at epoch 101
2026-02-05 16:20:39,643 - BrainGNN - INFO - Training completed. Best balanced_acc: 0.5000
2026-02-05 16:20:39,645 - BrainGNN - INFO - Best validation balanced_acc: 0.5000
2026-02-05 16:20:39,645 - BrainGNN - INFO - 
==================================================
2026-02-05 16:20:39,646 - BrainGNN - INFO - Evaluating on test set...
2026-02-05 16:20:39,646 - BrainGNN - INFO - ==================================================
2026-02-05 16:20:41,143 - BrainGNN - INFO - 
Test Results:
2026-02-05 16:20:41,144 - BrainGNN - INFO -   Loss:              0.3433
2026-02-05 16:20:41,146 - BrainGNN - INFO -   Accuracy:          0.8914
2026-02-05 16:20:41,149 - BrainGNN - INFO -   Balanced Accuracy: 0.5000
2026-02-05 16:20:41,150 - BrainGNN - INFO -   F1 Score:          0.0000
2026-02-05 16:20:41,152 - BrainGNN - INFO -   AUC:               0.5093
2026-02-05 16:20:41,153 - BrainGNN - INFO - 
Classification Report:
2026-02-05 16:20:41,162 - BrainGNN - INFO - 
              precision    recall  f1-score   support

     Class 0       0.89      1.00      0.94       509
     Class 1       0.00      0.00      0.00        62

    accuracy                           0.89       571
   macro avg       0.45      0.50      0.47       571
weighted avg       0.79      0.89      0.84       571

2026-02-05 16:20:41,177 - BrainGNN - INFO - 
Per-class metrics:
2026-02-05 16:20:41,183 - BrainGNN - INFO -   Class 0 - Precision: 0.8914, Recall: 1.0000
2026-02-05 16:20:41,185 - BrainGNN - INFO -   Class 1 - Precision: nan, Recall: 0.0000
2026-02-05 16:20:41,186 - BrainGNN - INFO - 
Saving training visualizations...
2026-02-05 16:20:41,897 - BrainGNN - INFO - Saved training history to /home/rif17002/honors_thesis/runs/2026-02-05_16-13-50/training_history_reward.png
2026-02-05 16:20:42,285 - BrainGNN - INFO - Saved confusion matrix to /home/rif17002/honors_thesis/runs/2026-02-05_16-13-50/confusion_matrix_reward.png
2026-02-05 16:20:42,286 - BrainGNN - INFO - Saving model to /home/rif17002/honors_thesis/runs/2026-02-05_16-13-50/brain_gnn_reward_diagnostic.pt
2026-02-05 16:20:42,298 - BrainGNN - INFO - Model saved successfully
2026-02-05 16:20:42,299 - BrainGNN - INFO - Saving results summary to /home/rif17002/honors_thesis/runs/2026-02-05_16-13-50/results_reward.yaml
2026-02-05 16:20:42,307 - BrainGNN - INFO - Results summary saved successfully
2026-02-05 16:20:42,308 - BrainGNN - INFO - 
==================================================
2026-02-05 16:20:42,308 - BrainGNN - INFO - Training completed successfully!
2026-02-05 16:20:42,308 - BrainGNN - INFO - All outputs saved to: /home/rif17002/honors_thesis/runs/2026-02-05_16-13-50
2026-02-05 16:20:42,309 - BrainGNN - INFO - ==================================================
