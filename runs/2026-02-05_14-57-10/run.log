2026-02-05 14:57:10,599 - BrainGNN - INFO - ==================================================
2026-02-05 14:57:10,602 - BrainGNN - INFO - Loading configuration from configs/config.yaml
2026-02-05 14:57:10,605 - BrainGNN - INFO - ==================================================
2026-02-05 14:57:10,616 - BrainGNN - INFO - Configuration loaded successfully
2026-02-05 14:57:10,620 - BrainGNN - INFO - Using device: cuda:0
2026-02-05 14:57:10,626 - BrainGNN - INFO - 
==================================================
2026-02-05 14:57:10,630 - BrainGNN - INFO - Configuration Summary
2026-02-05 14:57:10,633 - BrainGNN - INFO - ==================================================
2026-02-05 14:57:10,638 - BrainGNN - INFO - Run Directory: /home/rif17002/honors_thesis/runs/2026-02-05_14-57-10
2026-02-05 14:57:10,643 - BrainGNN - INFO - Data:
2026-02-05 14:57:10,649 - BrainGNN - INFO -   Data Directory: /shared/healthinfolab/datasets/ABCD/Irritability/WholeBrainTaskfMRI/UConn/data
2026-02-05 14:57:10,657 - BrainGNN - INFO -   Labels CSV: /shared/healthinfolab/datasets/ABCD/Irritability/WholeBrainTaskfMRI/UConn/subject_lists/CBCL_PLPH_m0m24_MID_n3705.csv
2026-02-05 14:57:10,659 - BrainGNN - INFO -   Contrast Type: reward
2026-02-05 14:57:10,664 - BrainGNN - INFO -   Edge Threshold: 0.0
2026-02-05 14:57:10,668 - BrainGNN - INFO -   Use Absolute Values: False
2026-02-05 14:57:10,671 - BrainGNN - INFO - 
Model:
2026-02-05 14:57:10,672 - BrainGNN - INFO -   GNN Type: GCN
2026-02-05 14:57:10,674 - BrainGNN - INFO -   Hidden Channels: 64
2026-02-05 14:57:10,676 - BrainGNN - INFO -   Num Layers: 3
2026-02-05 14:57:10,679 - BrainGNN - INFO -   Dropout: 0.4
2026-02-05 14:57:10,683 - BrainGNN - INFO - 
Training:
2026-02-05 14:57:10,689 - BrainGNN - INFO -   Batch Size: 32
2026-02-05 14:57:10,694 - BrainGNN - INFO -   Learning Rate: 0.001
2026-02-05 14:57:10,700 - BrainGNN - INFO -   Weight Decay: 0.0005
2026-02-05 14:57:10,704 - BrainGNN - INFO -   Epochs: 200
2026-02-05 14:57:10,708 - BrainGNN - INFO -   Patience: 50
2026-02-05 14:57:10,711 - BrainGNN - INFO -   Random Seed: 0
2026-02-05 14:57:10,715 - BrainGNN - INFO - 
Imbalance Handling:
2026-02-05 14:57:10,718 - BrainGNN - INFO -   Class Weights: True
2026-02-05 14:57:10,722 - BrainGNN - INFO -   Focal Loss: True
2026-02-05 14:57:10,726 - BrainGNN - INFO -   Focal Gamma: 1.5
2026-02-05 14:57:10,729 - BrainGNN - INFO -   Oversampling: False
2026-02-05 14:57:10,734 - BrainGNN - INFO -   Monitor Metric: f1
2026-02-05 14:57:10,737 - BrainGNN - INFO - 
==================================================
2026-02-05 14:57:10,742 - BrainGNN - INFO - Loading reward contrast dataset...
2026-02-05 14:57:10,748 - BrainGNN - INFO - ==================================================
2026-02-05 14:57:10,800 - BrainGNN - INFO - Loaded 3705 subjects from labels file
2026-02-05 14:57:15,637 - BrainGNN - INFO - Found 2853 subjects with complete data
2026-02-05 14:57:15,644 - BrainGNN - INFO - Class distribution:
2026-02-05 14:57:15,653 - BrainGNN - INFO -   Class 0: 2543 (89.1%)
2026-02-05 14:57:15,660 - BrainGNN - INFO -   Class 1: 310 (10.9%)
2026-02-05 14:57:15,666 - BrainGNN - INFO -   Imbalance ratio: 8.20:1
2026-02-05 14:57:15,669 - BrainGNN - INFO - Dataset loaded successfully with 2853 subjects
2026-02-05 14:57:16,728 - BrainGNN - INFO - Class weights: [0.56095165 4.601613  ]
2026-02-05 14:57:16,751 - BrainGNN - INFO - Number of ROIs (nodes): 352
2026-02-05 14:57:16,756 - BrainGNN - INFO - Number of node features: 6
2026-02-05 14:57:16,762 - BrainGNN - INFO - Number of edges: 123552
2026-02-05 14:57:16,770 - BrainGNN - INFO - Splitting dataset into train/val/test...
2026-02-05 14:57:43,538 - BrainGNN - INFO - Dataset split:
2026-02-05 14:57:43,543 - BrainGNN - INFO -   Train: 1825 samples
2026-02-05 14:57:43,548 - BrainGNN - INFO -   Val:   457 samples
2026-02-05 14:57:43,555 - BrainGNN - INFO -   Test:  571 samples
2026-02-05 14:57:53,132 - BrainGNN - INFO -   Train class dist: Class 0: 1627, Class 1: 198 (10.8% minority)
2026-02-05 14:57:55,540 - BrainGNN - INFO -   Val class dist: Class 0: 407, Class 1: 50 (10.9% minority)
2026-02-05 14:57:58,522 - BrainGNN - INFO -   Test class dist: Class 0: 509, Class 1: 62 (10.9% minority)
2026-02-05 14:58:15,528 - BrainGNN - INFO - 
Initializing GCN model...
2026-02-05 14:58:15,575 - BrainGNN - INFO - Model parameters: 11,298
2026-02-05 14:58:15,583 - BrainGNN - INFO - 
==================================================
2026-02-05 14:58:15,588 - BrainGNN - INFO - Training model...
2026-02-05 14:58:15,594 - BrainGNN - INFO - Monitoring: f1
2026-02-05 14:58:15,602 - BrainGNN - INFO - ==================================================
2026-02-05 14:58:15,853 - BrainGNN - INFO - Using Focal Loss with gamma=1.5
2026-02-05 14:58:15,860 - BrainGNN - INFO - Starting training for up to 200 epochs...
2026-02-05 14:58:20,469 - BrainGNN - INFO - Epoch 1: New best f1: 0.1972
2026-02-05 14:58:59,646 - BrainGNN - INFO - Epoch 010: Train Loss: 0.3303, Train Acc: 0.1085, Train Balanced Acc: 0.5000 | Val Loss: 0.3305, Val Acc: 0.1094, Val Balanced Acc: 0.5000, Val F1: 0.1972, Val AUC: 0.5261
2026-02-05 14:59:21,550 - BrainGNN - INFO - Epoch 15: New best f1: 0.1976
2026-02-05 14:59:43,514 - BrainGNN - INFO - Epoch 020: Train Loss: 0.3325, Train Acc: 0.1085, Train Balanced Acc: 0.4978 | Val Loss: 0.3303, Val Acc: 0.1094, Val Balanced Acc: 0.5000, Val F1: 0.1972, Val AUC: 0.5380
2026-02-05 15:00:27,816 - BrainGNN - INFO - Epoch 030: Train Loss: 0.3259, Train Acc: 0.1085, Train Balanced Acc: 0.5000 | Val Loss: 0.3293, Val Acc: 0.1094, Val Balanced Acc: 0.5000, Val F1: 0.1972, Val AUC: 0.5497
2026-02-05 15:01:12,200 - BrainGNN - INFO - Epoch 040: Train Loss: 0.3290, Train Acc: 0.1085, Train Balanced Acc: 0.5000 | Val Loss: 0.3304, Val Acc: 0.1094, Val Balanced Acc: 0.5000, Val F1: 0.1972, Val AUC: 0.5295
2026-02-05 15:01:56,603 - BrainGNN - INFO - Epoch 050: Train Loss: 0.3277, Train Acc: 0.1085, Train Balanced Acc: 0.5000 | Val Loss: 0.3291, Val Acc: 0.1094, Val Balanced Acc: 0.5000, Val F1: 0.1972, Val AUC: 0.5230
2026-02-05 15:02:41,335 - BrainGNN - INFO - Epoch 060: Train Loss: 0.3279, Train Acc: 0.1085, Train Balanced Acc: 0.5000 | Val Loss: 0.3295, Val Acc: 0.1094, Val Balanced Acc: 0.5000, Val F1: 0.1972, Val AUC: 0.5228
2026-02-05 15:03:03,591 - BrainGNN - INFO - Early stopping at epoch 65
2026-02-05 15:03:03,592 - BrainGNN - INFO - Training completed. Best f1: 0.1976
2026-02-05 15:03:03,593 - BrainGNN - INFO - Best validation f1: 0.1976
2026-02-05 15:03:03,595 - BrainGNN - INFO - 
==================================================
2026-02-05 15:03:03,596 - BrainGNN - INFO - Evaluating on test set...
2026-02-05 15:03:03,598 - BrainGNN - INFO - ==================================================
2026-02-05 15:03:04,488 - BrainGNN - INFO - 
Test Results:
2026-02-05 15:03:04,495 - BrainGNN - INFO -   Loss:              0.3279
2026-02-05 15:03:04,502 - BrainGNN - INFO -   Accuracy:          0.1086
2026-02-05 15:03:04,506 - BrainGNN - INFO -   Balanced Accuracy: 0.5000
2026-02-05 15:03:04,512 - BrainGNN - INFO -   F1 Score:          0.1959
2026-02-05 15:03:04,518 - BrainGNN - INFO -   AUC:               0.5577
2026-02-05 15:03:04,520 - BrainGNN - INFO - 
Classification Report:
2026-02-05 15:03:04,527 - BrainGNN - INFO - 
              precision    recall  f1-score   support

     Class 0       0.00      0.00      0.00       509
     Class 1       0.11      1.00      0.20        62

    accuracy                           0.11       571
   macro avg       0.05      0.50      0.10       571
weighted avg       0.01      0.11      0.02       571

2026-02-05 15:03:04,531 - BrainGNN - INFO - 
Per-class metrics:
2026-02-05 15:03:04,533 - BrainGNN - INFO -   Class 0 - Precision: nan, Recall: 0.0000
2026-02-05 15:03:04,534 - BrainGNN - INFO -   Class 1 - Precision: 0.1086, Recall: 1.0000
2026-02-05 15:03:04,534 - BrainGNN - INFO - 
Saving training visualizations...
2026-02-05 15:03:05,278 - BrainGNN - INFO - Saved training history to /home/rif17002/honors_thesis/runs/2026-02-05_14-57-10/training_history_reward.png
2026-02-05 15:03:05,683 - BrainGNN - INFO - Saved confusion matrix to /home/rif17002/honors_thesis/runs/2026-02-05_14-57-10/confusion_matrix_reward.png
2026-02-05 15:03:05,689 - BrainGNN - INFO - Saving model to /home/rif17002/honors_thesis/runs/2026-02-05_14-57-10/brain_gnn_reward_balanced.pt
2026-02-05 15:03:05,721 - BrainGNN - INFO - Model saved successfully
2026-02-05 15:03:05,726 - BrainGNN - INFO - Saving results summary to /home/rif17002/honors_thesis/runs/2026-02-05_14-57-10/results_reward.yaml
2026-02-05 15:03:05,753 - BrainGNN - INFO - Results summary saved successfully
2026-02-05 15:03:05,759 - BrainGNN - INFO - 
==================================================
2026-02-05 15:03:05,764 - BrainGNN - INFO - Training completed successfully!
2026-02-05 15:03:05,767 - BrainGNN - INFO - All outputs saved to: /home/rif17002/honors_thesis/runs/2026-02-05_14-57-10
2026-02-05 15:03:05,769 - BrainGNN - INFO - ==================================================
