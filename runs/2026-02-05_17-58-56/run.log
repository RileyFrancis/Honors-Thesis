2026-02-05 17:58:56,515 - BrainGNN - INFO - ==================================================
2026-02-05 17:58:56,516 - BrainGNN - INFO - Loading configuration from configs/config.yaml
2026-02-05 17:58:56,516 - BrainGNN - INFO - ==================================================
2026-02-05 17:58:56,520 - BrainGNN - INFO - Configuration loaded successfully
2026-02-05 17:58:56,521 - BrainGNN - INFO - Using device: cuda:0
2026-02-05 17:58:56,522 - BrainGNN - INFO - 
==================================================
2026-02-05 17:58:56,522 - BrainGNN - INFO - Configuration Summary
2026-02-05 17:58:56,522 - BrainGNN - INFO - ==================================================
2026-02-05 17:58:56,523 - BrainGNN - INFO - Run Directory: /home/rif17002/honors_thesis/runs/2026-02-05_17-58-56
2026-02-05 17:58:56,523 - BrainGNN - INFO - Data:
2026-02-05 17:58:56,523 - BrainGNN - INFO -   Data Directory: /shared/healthinfolab/datasets/ABCD/Irritability/WholeBrainTaskfMRI/UConn/data
2026-02-05 17:58:56,524 - BrainGNN - INFO -   Labels CSV: /shared/healthinfolab/datasets/ABCD/Irritability/WholeBrainTaskfMRI/UConn/subject_lists/CBCL_PLPH_m0m24_MID_n3705.csv
2026-02-05 17:58:56,524 - BrainGNN - INFO -   Contrast Type: reward
2026-02-05 17:58:56,525 - BrainGNN - INFO -   Edge Threshold: 0.1
2026-02-05 17:58:56,525 - BrainGNN - INFO -   Use Absolute Values: True
2026-02-05 17:58:56,525 - BrainGNN - INFO - 
Model:
2026-02-05 17:58:56,526 - BrainGNN - INFO -   GNN Type: GCN
2026-02-05 17:58:56,526 - BrainGNN - INFO -   Hidden Channels: 64
2026-02-05 17:58:56,526 - BrainGNN - INFO -   Num Layers: 3
2026-02-05 17:58:56,527 - BrainGNN - INFO -   Dropout: 0.4
2026-02-05 17:58:56,527 - BrainGNN - INFO - 
Training:
2026-02-05 17:58:56,528 - BrainGNN - INFO -   Batch Size: 32
2026-02-05 17:58:56,528 - BrainGNN - INFO -   Learning Rate: 0.001
2026-02-05 17:58:56,528 - BrainGNN - INFO -   Weight Decay: 0.0005
2026-02-05 17:58:56,528 - BrainGNN - INFO -   Epochs: 200
2026-02-05 17:58:56,529 - BrainGNN - INFO -   Patience: 50
2026-02-05 17:58:56,529 - BrainGNN - INFO -   Random Seed: 0
2026-02-05 17:58:56,530 - BrainGNN - INFO - 
Imbalance Handling:
2026-02-05 17:58:56,530 - BrainGNN - INFO -   Class Weights: True
2026-02-05 17:58:56,530 - BrainGNN - INFO -   Focal Loss: True
2026-02-05 17:58:56,530 - BrainGNN - INFO -   Focal Gamma: 2.0
2026-02-05 17:58:56,531 - BrainGNN - INFO -   Oversampling: False
2026-02-05 17:58:56,531 - BrainGNN - INFO -   Monitor Metric: balanced_acc
2026-02-05 17:58:56,531 - BrainGNN - INFO - 
==================================================
2026-02-05 17:58:56,532 - BrainGNN - INFO - Loading reward contrast dataset...
2026-02-05 17:58:56,532 - BrainGNN - INFO - ==================================================
2026-02-05 17:58:56,538 - BrainGNN - INFO - Loaded 3705 subjects from labels file
2026-02-05 17:58:57,729 - BrainGNN - INFO - Found 2853 subjects with complete data
2026-02-05 17:58:57,732 - BrainGNN - INFO - Class distribution:
2026-02-05 17:58:57,732 - BrainGNN - INFO -   Class 0: 2543 (89.1%)
2026-02-05 17:58:57,734 - BrainGNN - INFO -   Class 1: 310 (10.9%)
2026-02-05 17:58:57,734 - BrainGNN - INFO -   Imbalance ratio: 8.20:1
2026-02-05 17:58:57,735 - BrainGNN - INFO - Dataset loaded successfully with 2853 subjects
2026-02-05 17:58:58,792 - BrainGNN - INFO - Class weights: [0.56095165 4.601613  ]
2026-02-05 17:58:58,803 - BrainGNN - INFO - Number of ROIs (nodes): 352
2026-02-05 17:58:58,804 - BrainGNN - INFO - Number of node features: 6
2026-02-05 17:58:58,804 - BrainGNN - INFO - Number of edges: 75154
2026-02-05 17:58:58,804 - BrainGNN - INFO - Splitting dataset into train/val/test...
2026-02-05 17:59:20,606 - BrainGNN - INFO - Dataset split:
2026-02-05 17:59:20,607 - BrainGNN - INFO -   Train: 1825 samples
2026-02-05 17:59:20,607 - BrainGNN - INFO -   Val:   457 samples
2026-02-05 17:59:20,607 - BrainGNN - INFO -   Test:  571 samples
2026-02-05 17:59:28,119 - BrainGNN - INFO -   Train class dist: Class 0: 1627, Class 1: 198 (10.8% minority)
2026-02-05 17:59:29,990 - BrainGNN - INFO -   Val class dist: Class 0: 407, Class 1: 50 (10.9% minority)
2026-02-05 17:59:32,854 - BrainGNN - INFO -   Test class dist: Class 0: 509, Class 1: 62 (10.9% minority)
2026-02-05 17:59:46,260 - BrainGNN - INFO - 
Initializing GCN model...
2026-02-05 17:59:46,300 - BrainGNN - INFO - Model parameters: 11,298
2026-02-05 17:59:46,301 - BrainGNN - INFO - 
==================================================
2026-02-05 17:59:46,301 - BrainGNN - INFO - Training model...
2026-02-05 17:59:46,301 - BrainGNN - INFO - Monitoring: balanced_acc
2026-02-05 17:59:46,301 - BrainGNN - INFO - ==================================================
2026-02-05 17:59:46,515 - BrainGNN - INFO - Using Focal Loss with gamma=2.0
2026-02-05 17:59:46,515 - BrainGNN - INFO - Starting training for up to 200 epochs...
2026-02-05 17:59:49,887 - BrainGNN - INFO - Epoch 1: New best balanced_acc: 0.5000
2026-02-05 18:00:17,560 - BrainGNN - INFO - Epoch 010: Train Loss: 0.2686, Train Acc: 0.1085, Train Balanced Acc: 0.5000 | Val Loss: 0.2670, Val Acc: 0.1094, Val Balanced Acc: 0.5000, Val F1: 0.1972, Val AUC: 0.5697
2026-02-05 18:00:47,564 - BrainGNN - INFO - Epoch 020: Train Loss: 0.2595, Train Acc: 0.1085, Train Balanced Acc: 0.5000 | Val Loss: 0.2621, Val Acc: 0.1094, Val Balanced Acc: 0.5000, Val F1: 0.1972, Val AUC: 0.5595
2026-02-05 18:01:18,119 - BrainGNN - INFO - Epoch 030: Train Loss: 0.2601, Train Acc: 0.1085, Train Balanced Acc: 0.5000 | Val Loss: 0.2885, Val Acc: 0.1094, Val Balanced Acc: 0.5000, Val F1: 0.1972, Val AUC: 0.4243
2026-02-05 18:01:48,620 - BrainGNN - INFO - Epoch 040: Train Loss: 0.2602, Train Acc: 0.1085, Train Balanced Acc: 0.5000 | Val Loss: 0.2665, Val Acc: 0.1094, Val Balanced Acc: 0.5000, Val F1: 0.1972, Val AUC: 0.5827
2026-02-05 18:02:18,943 - BrainGNN - INFO - Epoch 050: Train Loss: 0.2604, Train Acc: 0.1085, Train Balanced Acc: 0.5000 | Val Loss: 0.2593, Val Acc: 0.1094, Val Balanced Acc: 0.5000, Val F1: 0.1972, Val AUC: 0.5998
2026-02-05 18:02:21,971 - BrainGNN - INFO - Early stopping at epoch 51
2026-02-05 18:02:21,972 - BrainGNN - INFO - Training completed. Best balanced_acc: 0.5000
2026-02-05 18:02:21,973 - BrainGNN - INFO - Best validation balanced_acc: 0.5000
2026-02-05 18:02:21,973 - BrainGNN - INFO - 
==================================================
2026-02-05 18:02:21,973 - BrainGNN - INFO - Evaluating on test set...
2026-02-05 18:02:21,973 - BrainGNN - INFO - ==================================================
2026-02-05 18:02:22,565 - BrainGNN - INFO - 
Test Results:
2026-02-05 18:02:22,565 - BrainGNN - INFO -   Loss:              0.2679
2026-02-05 18:02:22,566 - BrainGNN - INFO -   Accuracy:          0.1086
2026-02-05 18:02:22,566 - BrainGNN - INFO -   Balanced Accuracy: 0.5000
2026-02-05 18:02:22,566 - BrainGNN - INFO -   F1 Score:          0.1959
2026-02-05 18:02:22,566 - BrainGNN - INFO -   AUC:               0.4658
2026-02-05 18:02:22,566 - BrainGNN - INFO - 
Classification Report:
2026-02-05 18:02:22,572 - BrainGNN - INFO - 
              precision    recall  f1-score   support

     Class 0       0.00      0.00      0.00       509
     Class 1       0.11      1.00      0.20        62

    accuracy                           0.11       571
   macro avg       0.05      0.50      0.10       571
weighted avg       0.01      0.11      0.02       571

2026-02-05 18:02:22,573 - BrainGNN - INFO - 
Per-class metrics:
2026-02-05 18:02:22,574 - BrainGNN - INFO -   Class 0 - Precision: nan, Recall: 0.0000
2026-02-05 18:02:22,574 - BrainGNN - INFO -   Class 1 - Precision: 0.1086, Recall: 1.0000
2026-02-05 18:02:22,574 - BrainGNN - INFO - 
Saving training visualizations...
2026-02-05 18:02:23,230 - BrainGNN - INFO - Saved training history to /home/rif17002/honors_thesis/runs/2026-02-05_17-58-56/training_history_reward.png
2026-02-05 18:02:23,617 - BrainGNN - INFO - Saved confusion matrix to /home/rif17002/honors_thesis/runs/2026-02-05_17-58-56/confusion_matrix_reward.png
2026-02-05 18:02:23,624 - BrainGNN - INFO - Saving model to /home/rif17002/honors_thesis/runs/2026-02-05_17-58-56/brain_gnn_reward_balanced.pt
2026-02-05 18:02:23,630 - BrainGNN - INFO - Model saved successfully
2026-02-05 18:02:23,631 - BrainGNN - INFO - Saving results summary to /home/rif17002/honors_thesis/runs/2026-02-05_17-58-56/results_reward.yaml
2026-02-05 18:02:23,636 - BrainGNN - INFO - Results summary saved successfully
2026-02-05 18:02:23,636 - BrainGNN - INFO - 
==================================================
2026-02-05 18:02:23,636 - BrainGNN - INFO - Training completed successfully!
2026-02-05 18:02:23,636 - BrainGNN - INFO - All outputs saved to: /home/rif17002/honors_thesis/runs/2026-02-05_17-58-56
2026-02-05 18:02:23,637 - BrainGNN - INFO - ==================================================
